---
title: "hw3_nn2477"
author: "Nhu Nguyen"
date: "2023-10-11"
output: github_document
---
## loading necessary libraries 
```{r}
library(tidyverse)
library(ggplot2)
library(p8105.datasets)
data("instacart")
```

## getting the number of unique aisles
```{r}
instacart %>% 
  summarise(count = n_distinct(aisle))
```

## getting the aisles with the most item ordered
```{r}
instacart %>% 
  group_by(aisle) %>% 
  summarise(total_items = n()) %>% 
  arrange(desc(total_items))
```

## making plot for aisle and number of items ordered 

```{r}
instacart %>% 
  group_by(aisle) %>% 
  summarise(total_items = n()) %>% 
  filter(total_items > 10000) %>% 
  arrange(desc(total_items)) %>% 
ggplot(aes(x = reorder(aisle, -total_items), y = total_items)) +
  geom_bar(stat = "identity", fill = "skyblue") + 
  labs (
    title = "number of items ordered in each aisle", 
    x = "aisle",
    y = "total items ordered"
  ) + 
  coord_flip() + 
  theme_minimal()
```

## making a table for the three most popular items 

```{r}
instacart %>% 
  filter(aisle %in% c("baking ingredients", "dog food care", "packaged vegetables fruits")) %>% 
  group_by(aisle, product_name) %>% 
  summarise(order_count = n()) %>% 
  arrange(aisle, desc(order_count)) %>% 
  group_by(aisle) %>% 
  slice_max(order_count, n = 3) %>% 
  pivot_wider(
    names_from = aisle,
    values_from = order_count)
```

## create table for pink landy apples and coffee ice cream 
```{r}
instacart %>% 
  mutate(order_dow = recode(
    order_dow,
    "0" = "sunday",
    "1" = "monday",
    "2" = "tuesday",
    "3" = "wednesday",
    "4" = "thursday",
    "5" = "friday",
    "6" = "saturday"), 
    order_hour_of_day = ifelse(
      order_hour_of_day <= 12, 
      paste0(order_hour_of_day, "AM"),
      paste0(order_hour_of_day - 12, "PM")))
    
```

